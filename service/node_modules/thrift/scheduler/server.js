var thrift = require('thrift');
var sys = require('sys');

var scheduler_thrift = require('./gen-nodejs/JobExchange.js'),
    scheduler_ttypes = require('./gen-nodejs/scheduler_types.js');

Array.prototype.blah = function() {
}

var thrift_server = thrift.createServer(scheduler_thrift,{
  'get_all':function(success){
      var job = new scheduler_ttypes.Job({'id':5,'type':'minute'});
      var job2 = new scheduler_ttypes.Job({'id':10,'type':'hour'});
      success([job,job2]);

  },
  'get_job':function(jid,success){
      console.log(jid,'GET JOB, JOB ID')
      success(jid);
  },
  'insert_job':function(job,success){
      console.log(sys.inspect(job),'INSERT JOB');
      success(job);

  }
});

thrift_server.listen(8081);
